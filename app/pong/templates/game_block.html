{% load static %}

{% if hx_push_url %}
<script hx-push-url="{{ hx_push_url }}"></script>
{% endif %}

<br>
<script>
document.getElementById('speedBall').addEventListener('input', function() {
    document.getElementById('speedBallValue').textContent = this.value;
});

document.getElementById('sizePaddle').addEventListener('input', function() {
    document.getElementById('sizePaddleValue').textContent = this.value;
});

document.getElementById('speedPaddle').addEventListener('input', function() {
    document.getElementById('speedPaddleValue').textContent = this.value;
});
</script>
<button id="modeOne">Partie simple</button>
<br>

<div class="startgame_bigger_container">
	<div class="startgame_container d-flex" id="startgame_container">
		<h1 class="text_startgame">Enter your nickname please :D</h1>
		<input type="text" placeholder="Player 2" required class="startgame_playerform" id="player2name">
		<button id="player2nameButton" class="btn startgame_btn">Start the game</button>
		<button class="btn_setting" id="modeTwo">Game Setting</button>
	</div>
	<div class="container_setting_pong" id="setting_pong">
		<label class="switch">
			<input type="checkbox" />
			<span></span>
		</label>
		<input type="range" min="1" max="10" value="5" id="speedBall" class="slider" style="background-color:  violet">
		<span id="speedBallValue" class="slider_text">5 Speed Ball</span>
		<input type="range" min="1" max="10" value="5" id="sizePaddle" class="slider1">
		<span id="sizePaddleValue" class="slider_text1">5 Size Paddle</span>
		<input type="range" min="1" max="10" value="5" id="speedPaddle" class="slider2">
		<span id="speedPaddleValue" class="slider_text2">5 Speed Paddle</span>
	</div>
</div>

<br>
<button id="tournament_Button" style="display: none; background-color: white;">Commencer le tournoi</button>
<script>
	function yolo() {
		let modedici = new URL(window.location.href).pathname.split("/")[3];
		if (modedici == "tournament") {
			document.getElementById('tournament_Button').style.display = 'block';
			document.getElementById('player2name').style.display = 'none';
			document.getElementById('player2nameButton').style.display = 'none';
		}
	}
	yolo();
</script>
<script>

	var host_name = '{{ user.username }}';
	var player1 = '{{ user.username }}';
	var player2 = '{{ player2 }}';
	var player3 = '{{ player3 }}';
	var player4 = '{{ player4 }}';
	var player5 = '{{ player5 }}';
	var player6 = '{{ player6 }}';
	var player7 = '{{ player7 }}';
	var player8 = '{{ player8 }}';
	var name_player2 = 'Player 2';

	var save_game;
	var save_tournament;

	var speed = document.getElementById('speedBall');
	var sizePaddle = document.getElementById('sizePaddle');
	var speedPaddle = document.getElementById('speedPaddle');
	var modeOne = document.getElementById('modeOne');
	var modeTwo = document.getElementById('modeTwo');

	function init() {
		let url = new URL(window.location.href);
		let mode = url.pathname.split("/")[3];
		save_game = '{% url "game_save" %}';
		save_tournament = '{% url "tournament_save" %}';
		speed.style.display = 'none';
		sizePaddle.style.display = 'none';
		speedPaddle.style.display = 'none';
		modeOne.style.display = 'none';
		modeTwo.style.display = 'none';
		if (mode == 'pvp')
		{
			modeOne.style.display = 'block';
			modeTwo.style.display = 'block';
			document.getElementById('startgame_container').style.display = 'block';

		}
	}
	init();

	function startGame() {

		let url = new URL(window.location.href);
		let mode = url.pathname.split("/")[3];

		if (mode == 'pvp') {
			name_player2 = document.getElementById('player2name').value;
			if (name_player2.length > 10)
				name_player2 = name_player2.substring(0, 10);
			if (name_player2 != '') {
				console.log("test");
				document.getElementById('player2name').style.display = 'block';
				document.getElementById('player2nameButton').style.display = 'block';
				document.getElementById('startgame_container').style.display = 'block';
				window.startGameFunctionPVP();
			}
			else {
				alert('Enter something ðŸ¤¨')
				return;
			}
		} else if (mode == 'pve') {
			name_player2 = "Glados"
			document.getElementById('player2name').style.display = 'none';
			document.getElementById('player2nameButton').style.display = 'none';
			document.getElementById('startgame_container').style.display = 'none';
			window.startGameFunctionPVE();
		} else if (mode == 'tournament') {
			document.getElementById('tournament_Button').style.display = 'none';
			document.getElementById('startgame_container').style.display = 'none';
			window.startGameFunctionTournament();
		}
	}
	document.getElementById('tournament_Button').addEventListener('click', startGame);
	document.getElementById('player2nameButton').addEventListener('click', startGame);



	speedBall.addEventListener('input', function () {
		window.speed = speed.value;
	});

	sizePaddle.addEventListener('input', function () {
		window.sizePaddle = sizePaddle.value;
	});
	speedPaddle.addEventListener('input', function () {
		window.speedPaddle = speedPaddle.value;
	});

	modeOne.addEventListener('click', function () {
	//	document.getElementById('startgame_container').style.display = 'block';
		modeOne.style.display = 'none';
		modeTwo.style.display = 'none';
	});


	modeTwo.addEventListener('click', function () {
		speed.style.display = 'block';
		sizePaddle.style.display = 'block';
		speedPaddle.style.display = 'block';
		modeOne.style.display = 'none';
	});

	document.addEventListener("DOMContentLoaded", function() {
    var startgameContainer = document.getElementById("startgame_container");
    var gameSettingButton = document.getElementById("modeTwo");
    var pongContainer = document.getElementById("setting_pong");

    // Add event listener to gameSettingButton
    gameSettingButton.addEventListener("click", function() {
        // Toggle the CSS classes
		startgameContainer.classList.toggle("animation_stc");
		pongContainer.classList.toggle("visible");
    });
});
</script>

<canvas id="pongCanvas"></canvas>
<script type="module" src="{% static 'pong/js/pong.js' %}" defer></script>
